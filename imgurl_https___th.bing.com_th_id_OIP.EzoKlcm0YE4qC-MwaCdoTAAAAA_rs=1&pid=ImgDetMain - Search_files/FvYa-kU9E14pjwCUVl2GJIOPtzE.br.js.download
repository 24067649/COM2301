var __spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))};define("clientinst_xls",["require","exports"],function(n,t){function or(){function n(n,t){n in i||(i[n]=t)}i=_w[fi]=_w[fi]||{};n(b,2e3);n(si,1e3);n(hi,5e5);n(ci,1e5);n(li,500);n(o,!0);n(ai,3)}function vi(){ct=0;ri=_G.ST?_G.ST.getTime():0;vt=!1}function l(n,t,r,u){var e,f,s;i[o]&&(e=(new Date).getTime(),f={errorType:n,failCount:t,ImpressionGuid:r,TS:e,SEQ:ct++},f[h]=nt+"LER",pi(f),u?(ui++,ui>i[ai]&&(f.errorType="Overload",i[o]=!1),s={impressionGuid:r,timestamp:e,data:{eventType:st,eventData:f}},di([s])):k(st,f,null))}function sr(){or();vi();try{y=_w.localStorage;u.initialize()}catch(n){}}function yi(n){u.append(n);c()}function kt(n){return JSON.stringify(n).replace(/]]>/g,"]]]\]><![CDATA[>")}function r(n,t,i){n.push("<",t,">",i,"<\/",t,">")}function hr(n,t,i){var s,e=n.data,o=e.eventData,h,u,f;o||(o=e.eventData={});t.push("<E>");r(t,"T","Event."+e.eventType);r(t,"IG",o.OvrIG||n[pt]);n[wt]&&(r(t,"PrevIG",n[wt]),n[bt]&&r(t,"DominantIG",n[bt]));h=e.dataSources;h&&r(t,"DS","<![CDATA["+kt(h)+"]\]>");u=e.pageLayout;u&&(t.push("<Page>"),f=!1,"Name"in u&&(r(t,"Name",u.Name),f=!0),"Number"in u&&(r(t,"Num",u.Number),f=!0),"IID"in u&&(r(t,"IID",u.IID),f=!0),"SFX"in u&&(r(t,"SFX",u.SFX),f=!0),f&&(u=(s=u.L)!==null&&s!==void 0?s:[]),r(t,"L","<![CDATA["+kt(u)+"]\]>"),t.push("<\/Page>"));o.UTS=i;r(t,"D","<![CDATA["+kt(o)+"]\]>");r(t,"TS",n[ei]);t.push("<\/E>")}function pi(n){var t=_w.location.href,i;return tt&&t.indexOf(tt)===0||(i=t.indexOf("?"),i<0&&(i=t.indexOf("#")),tt=i<0?t:t.substring(0,i)),n.CurUrl=tt,n}function wi(n){var t=["<ClientInstRequest>"],l=(new Date).getTime(),o=_G.CID||sj_cook.get(ni,ni),e,i,s,u,h,f;if(o&&r(t,"CID",o),n.length>0){for(e=n[0].data,e.eventType==ht&&(i=e.pageLayout,i&&i.IID&&i.SFX&&(s=i.IID+"_"+i.SFX,r(t,"AppNS",s))),t.push("<Events>"),u=0;u<n.length;u++)h=n[u],hr(h,t,l);t.push("<\/Events>")}if(t.push("<\/ClientInstRequest>"),f=t.join(""),_G.EnableCompression&&_w.fflate){var a=_w.fflate.strToU8(f),v=_w.fflate.deflateSync(a),c=btoa(String.fromCharCode.apply(String,v));if(c.length<f.length)return p=bi(_G.XLSC),c}return p=bi(_G.XLS),f}function bi(n){var t="";return _G.XLSOvr&&(t+="&f="+_G.XLSOvr),t.length>0&&(t="?"+t.substring(1)),n+t}function c(n){if(n===void 0&&(n=!1),i[o]){var t=n?s[w]:s[it];t[rt]||(t[rt]=setTimeout(function(){return ut(n,!1)},t.getInterval()))}}function ut(n,t,r){var e,d,a,v,y,k,h;if(i[o]&&(e=n?s[w]:s[it],clearTimeout(e[rt]),e[rt]=null,!n||!s[it][f])){if(!n&&s[w][f]&&s[w][f].abort(),e[f])if(d=(new Date).getTime()-e[oi],d>i[b])e[f].abort(),e[f]=null,l("TimedOut",1,_G.IG);else return;if(a=u.getBatch(n),a.length!=0){if(v=a.map(function(n){return n.log}),y=r&&r.useSendBeacon,y&&dt(v,"SB"),k=wi(v),y&&lr(p,k)){e[f]&&t&&(e[f].abort(),e[f]=null);u.clearSentItems(n,!0)&&!n&&c(!1);c(!0);return}h=sj_gx();h.open("POST",p,!0);i[b]>=1e3&&(h.timeout=i[b]);h.onload=function(){return cr(h,e,n)};h.setRequestHeader("Content-type","text/xml");e[f]=h;e[oi]=(new Date).getTime();h.send(k)}}}function dt(n,t,i){n.forEach(function(n){var r,u;(r=(u=n.data.eventData)[ot])!==null&&r!==void 0?r:u[ot]={};n.data.eventData[ot][t]=i!==null&&i!==void 0?i:"1"})}function cr(n,t,i){if(n.readyState===4){t[f]=null;var r=Math.floor(n.status/100);r===2?(u.clearSentItems(i)&&!i&&c(!1),c(!0)):r===4?(u.markFailedItems(!0,i),c(!0)):u.markFailedItems(!1,i);i&&u.recordRetryAttempt()}}function ki(n,t,i,r,u,f,e,o,s){for(var y,h,l,a,c,v=0,p=er;v<p.length;v++)y=p[v],_w[lt]&&_w[lt][y]&&_w[lt][y](t);if(h={},pi(h),t)if(typeof t=="string")h.Text=t;else for(l in t)t.hasOwnProperty(l)&&(h[l]=t[l]);return i&&(i.substring(0,3)==="CI."&&(i=i.substring(3)),h.T="CI."+i),a=s||(new Date).getTime(),h.TS=a,h.RTS=a-ri,h.SEQ=ct++,c={},c[pt]=f||h.ImpressionGuid||_G.IG,c[wt]=e,c[ei]=a,c.data={eventType:n||ti,eventData:h,dataSources:r,pageLayout:u},c[bt]=o,c}function di(n){var i=wi(n),t=sj_gx();t.open("POST",p);t.setRequestHeader("Content-type","text/xml");t.send(i)}function gi(n,t){var r=[];for(var i in n)n.hasOwnProperty(i)&&(typeof n[i]=="string"&&(n[i]=decodeURIComponent(n[i])),r.push(i,n[i]));a(n.T,n.FID,n.Name,t,r,"DL")}function gt(n){(new Image).src=_G.lsUrl+"&Type=Event.ClientInst&DATA="+n}function nr(n,t,i){var r,u,f,e;if(_G.DirectLogFlight!=null&&t<=_G.DirectLogFlight)try{r=null;try{r=JSON.parse(n)}catch(o){r=JSON.parse(decodeURIComponent(n))}if(Array.isArray(r))for(u=0,f=r;u<f.length;u++)e=f[u],gi(e,i);else r!==null&&typeof r=="object"?gi(r,i):gt(n)}catch(o){a("Info","XLS","DLErr",!1,["Message",o.message,"EventData",n],"DL");gt(n)}else gt(n)}function k(n,t,r,u,f,e,s,c,l){var a,v;if(i[o]){if(t!==null&&t!==void 0?t:t={},t[h]=(a=t[h])!==null&&a!==void 0?a:nt+"LE",v=ki(n,t,r,u,f,e,s,c,l),n===ht){di([v]);return}yi(v)}}function tr(n){var t;k(ii,(t={queryTags:n.join(",")},t[h]="F",t),ii)}function lr(n,t){var i="sendBeacon",r=!1;if(navigator&&navigator[i])try{r=navigator[i](n,t)}catch(u){l("SBFail",1,_G.IG)}return r}function ur(n,t){n===void 0&&(n=!0);!_G.XLSNoFlush&&t&&t.useSendBeacon&&(u.dumpToStorage(),ut(!1,!0,t))}function ft(){u.dumpToStorage();ut(!1,!1)}function et(){u.dumpToStorage();_G.XLSUnload&&(at=!0,ut(!1,!0,{useSendBeacon:!0}))}function fr(n,t,i){n!==null&&n!==void 0?n:n={};n[h]=nt+"LP";k(ht,n,"ClientSidePartialImpression",t,i)}var g,u,s,ir,rr,a,v,d;t.__esModule=!0;t.LogPartialImpression=t.FlushMainQueueDontForce=t.ForceFlush=t.Log2=t.Log=t.LogFilterFlare=t.LogEvent=t.DirectLog=void 0;var nt="XLS-",h="SDK",ot="XLSF",ni="MUID",st="CIQueueError",ht="PartialDynamicContent.FrontDoor",ti="ClientInst",ii="FilterFlare",i,ct,ri,y,tt,ui=0,p=_G.XLS,fi="ClientInstConfig",lt="XLS_PreProcessor",er=["ChatPrivacy"],at=!1,vt=!1,e="inProgress",yt="retried",pt="impressionGuid",wt="previousImpressionGuid",bt="dominantImpressionGuid",ei="timestamp",f="currentRequest",oi="requestSentTimestamp",it="mainQueue",w="retryQueue",rt="flushTimeoutHandle",b="flushInterval",si="retryInterval",hi="maxStorageUse",ci="maxBatchSize",li="queueDumpInterval",o="isInstrumentationEnabled",ai="maxDirectErrors";(function(n){function w(n){var t=["proactive","search","zinc"].some(function(t){return n.indexOf(t)==1});return"eventLogQueue"+(t?"_Online":"_Offline")}function v(){return f&&i[o]}function u(){var n,t;if(v()){n=tt();try{t=h;y[t]=n}catch(i){if(i.name.toLowerCase().indexOf("quota")>=0)f=!1;else throw i;}}}function a(){v()&&(s&&clearTimeout(s),s=setTimeout(u,i[li]))}function b(){var n,o,i,u,r;if(y){if(n=y[h],t=[],typeof n=="string"||n&&n.length!==0)try{if(t=JSON.parse(n),t.some(function(n){return!n.log}))l("LSItemErr",t.length,_G.IG),t=[];else if(o=t.length,o>0){for(i=0,u=t;i<u.length;i++)r=u[i],dt([r.log],"RE",r[e]?"IP":"NS"),r[e]=!1;c()}}catch(s){l("LSErr",0,_G.IG)}y[h]="[]";f=!0}}function k(n){var h=[],o=n?r[0]:t,s,c,f,u;if(o)for(s=0,c=o.length,f=0;f<c;f++)if(u=o[f],n||!u[yt])if(s+=u.size,s<=i[ci])u[e]=!0,h.push(u);else break;return h}function d(n,i){return i===void 0&&(i=!1),t=t.filter(function(t){return!t[e]&&(!n||t[yt])}),i?u():a(),t.length>0}function g(n,i){for(var f=[],h=i?r[0]:t,o=0,u,s,c;o<h.length;)if(u=h[o],u[e])if(dt([u.log],"retry",n?"BR":"RE"),n){if(h.splice(o,1),u.log.data&&u.log.data.eventType===st)continue;u[yt]=!0;f.push(u)}else u[e]=!1,o++;else o++;s=f.length;s==1?l("LogDrop",1,f[0].log[pt]):s>0&&(c=s/2,r.push(f.slice(0,c)),r.push(f.slice(c)));a()}function nt(){var n,t,i;if(r.length>0){for(n=r[0],t=0;t<n.length;)i=n[t],i[e]?n.splice(t,1):t++;n.length==0&&r.shift()}}function tt(){var e=JSON.stringify(t),u=e.length-i[hi],o=t.length,r,n,f;if(u>0)for(r=0,n=0;n<o;n++)if(f=t[n].size,r+=f+1,r>=u){t.splice(0,n+1);l("QueueTrim",n+1,_G.IG,!0);break}return JSON.stringify(t)}function it(n){var i,r=(i={log:n,retried:!1},i[e]=!1,i.size=0,i),f=JSON.stringify(r).length+3;r.size=f;t.push(r);at?u():a()}var t=[],f=!1,s=null,r=[],p=_w.location.pathname,h=w(p);n.dumpToStorage=u;n.initialize=b;n.getBatch=k;n.clearSentItems=d;n.markFailedItems=g;n.recordRetryAttempt=nt;n.append=it})(u||(u={}));s=(g={},g[it]={getInterval:function(){return i[b]}},g[w]={getInterval:function(){return i[si]}},g);t.DirectLog=nr;t.LogEvent=k;t.LogFilterFlare=tr;ir=function(n,t,i,r){for(var f=[],u=4;u<arguments.length;u++)f[u-4]=arguments[u];a(n,t,i,r,f,"L")};t.Log=ir;rr=function(n,t,i,r,u,f,e){var o=Object.keys(e).reduce(function(n,t){return __spreadArray(__spreadArray([],n,!0),[t,e[t]],!1)},[]);i&&o.push("Service",i);r&&o.push("Scenario",r);u&&o.push("AppNS",u);f&&o.push("K",f);a(n,null,t,!1,o,"L2")};t.Log2=rr;a=function(n,t,r,u,f,e){var l,s,c,v,y;if(i[o]){if(vt||(vt=!0,a("Init","CI","Base",!1,[],"L")),s={},f&&f.length>0&&f.length%2==0)for(c=0;c<f.length;c+=2)(v=f[c],y=f[c+1],v)&&(s[v]=y);(l=s[h])!==null&&l!==void 0?l:s[h]=nt+(e!==null&&e!==void 0?e:"");s.hasOwnProperty("K")||typeof t!="number"||(s.K=t);s.Name=r||"";s.FID=typeof t!="number"?t||"VoidFID":"KFID";yi(ki(ti,s,n))}};t.ForceFlush=ur;t.FlushMainQueueDontForce=ft;t.LogPartialImpression=fr;sr();v="sj_evt";d="sj_be";_w[v]&&(_w[v].bind("onP1",ft,!0),_w[v].bind("ajax.postload",ft,!0),_w[v].bind("ajax.unload",vi),_G.XLSUnload&&_w[v].bind("unload",et));_w[d]&&(_w[d](_w,"beforeunload",et),_G.XLSUnload&&(_w[d](_w,"pagehide",et),_w[d](_d,"visibilitychange",function(){_d.visibilityState==="hidden"?et():at=!1})));_w.Log={Log:t.Log,LogFilterFlare:tr,DirectLog:nr};_w.Log2={LogEvent:k,ForceFlush:ur,FlushMainQueueDontForce:ft};_w.sj_log2=t.Log2;_w.cspi_log=fr})